(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{243:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANwAAABqCAYAAADXyT/pAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAA23SURBVHhe7Z3Pr1VXFcf5Q0ycENsKEV9KlIjFBAq1BaG80gj+aAlKIYg2SEoEin20IaiFV1ptnxgNHXTgjyGOmBBb34RgfIMSjTF2YNRJExMHxonZ9nvN93a99dY+v+8+Z9+7Bp/ce/beZ+9zb9bnrn1+3nXr168PjuOkwYVznIS4cI6TEBfOcRLiwjlOQlw4x0mIC+c4CXHhHCchLtwA2L59e7h9+3a4d+9euHnz5rj81KlTYWVlZVR+6dKlVeuUsWvP0XDh5bvhxz//b7j+y7AGlKMe7az1ncmQXDgZXATLKLfal3Hjxo1xPwhOBKkMVIkM5i6ABHfu3AkHDhww66uC7Sr6DvAZ63xHkMiSLIZLl47kwiE4EaT8xaYcCCrdtgysUxTw6Bv1eLXq21JXBAts+/LycuE24ruqMw4ylyVWDLS3+nG6p7Fwp0+fDlevXo1y+fLlsGHDhjXrIbAQYJQEQYRgqisc1yuaanWVgSyabrdGfx8WGKNOdo5NI498862wYdMjYfFn768qR3urH6d7Ggs3Nzc3ksqSDWzbts1cT/9aI9BkxpNlnApav+5VspeVgRjgS0tL474XFxdXTTm5jefPnx9PTbW41nY3oUqWxHbVEVvKVBWrH6d7Wk0pd+7cacp2+PBhsz1A8DCwmSVkwEEIBDkDmW0YcFiXIkq4/4Y2RI5FKBzAGFgP/UM6bgfGgkzMPHob2E+Z8FXA9pXJVKWNRMu094svhnXr1oWPfHRTePHaH9fUA6sfp3ta78OdPHlylWwLCwvmVBIwcKUoUggrsJlJdMBhmYLIcmL1BSgZRJHv0Y7bgleZ0ay+sK5sUwf5PfCHpQi2t35ULCyhAMQ789JvzTqrH6d7WgsHueTUMjaVBHoahsCWwiGYEFRSSKClAVjPKifoy8pAWIeiyvHZnyWXVSbXbQq+B26LVQ9in6MIS6gfvfXvsGvvc57heqa1cIBTy6KpJNDBo7MEyssOIAAtroXum2ix0A5tMC7Gt/rW220J2IQqnxdj1BXbEgoHSpDhIJ5Vb/XjdE8nwoFDhw5Fp5JES6CDGwGIDCeD3UILYIFA1dkjJpkMfPke63AbpVxaOCxDCq5TFWyH3kYNfyCsuhjWUUpktiefXlxTDvwoZTo6E64K1q81lmUZgrBsSok2UlxCEfT6DOqYWDLwrfFRJscB2CbWV9230ljfh4Sfxxq/COs8HITDQRMcPEGmk3V+Hi4dSYXrirJAbYP+AZgUlEn/mEggcVkmt/ArTYZLdsIh+KpMO5tQRYKu4FhFcqOOmdeqLwISIXPFToKjHPUuW1qyEe75Cy+EN37yZrh85Yfh6a+fDJ94cGvn7Nr9RHjh0pVw4EtHzPquwTgvff/aCDnmyW+fHX3O8xe/Fx7a8diobOPcp8PH7n/A/G6cfMhCOATclh3zzgfgu7C+IycPBi+cy7YWly5fBi0cplBWwDnzPr3MlEELh/0WK9ic+dF3Y31nzrAZtHA+nYzj08o8ceEyxYXLExcuU1y4PJkp4Y7tez78+eTfwl+/9f6I8wcWzXZ9snP3iXDt3D/D9YUw5vUL/wlPHLi4qp0LlyczmeH2PXosvHviL4MV7sp3/rFGMI0LlycunFHfJy7cdJONcNe//IuRJJCFZRQHdSy7eeQ34yljbNoYEw7Legz0B7j88K6vhneeWRn3j/coYz2Y/8rx8PY7y+Hu3d+Fr33jzKq6Mly46SYb4SxJtCBYlvWWpKCpcJRNCoj3Wrq2wul9uGeP/npNOxcuT7KaUsrg57LMbhocJHn3xHujV1neVDj0c/f4H1bVx8boCmQ6HDTR0rlweZKVcDLgAd7LQKdIckqJo5JaBrarKxzqZd9FY3TJd5/9/QhZ5sLlSVbCcUqHwAcUQdbJMkgw6Qw3aT73yFPh8nPvuXBTQlbCAYoGpDCUiFNMClgnw2lB0RcyGIWzpLZosw+nwVTSz8NND9kJR1n0gQoAgeRU75VDb66adlIgjdwPhEwsx3vUScEonVxfb0sb4bjPxgMmyG7IcrqdC5cn2Qnn/B8XLk9cuExx4fLEhcsUFy5PBi2c34Aax29AzZNBC+ePWIjjj1jIk0ELB3xauRafTubL4IUDLt2HuGx5k4VwjjMtuHCOkxAXzkkG/itB/2+D/OciWT6t9CYc/k/u4MGDZt00s+OTO8Ore5fCG4//dMT+T9X7T7m+eHj+V+HJE/8K88/8/YP9yMfNNkXE/pjE+v+9aaZX4fCvqWfPng1btmwx20wCBPyVL7w2erXqU7H545vDlT2vZiEcZHv00Nvhvvs3mfVllP0LELKc9X9/00jvwpH9+/eb7brGhavHAxs+E/Yd+VPYvPWYWV9GFZmY5SbxF2RDYzDCgdOnT4e5uTmzPWCQcjpGjj50fNzmzI5z43K0xToo11M5iVy/CLSTfQJuU2wbgCVVTDgs6zHQH+Dyxvs2houfvzTuH+9RxnrA/59rmzkgGoSDeFZ9EVWni9zWWZhWDko4sLCwYErHIGPgcVkHugw+S5A2Gc6SRAuCZVlvbQOw+gK6PyCF098D67V0XQmH6SSw6sqoM1W0DqhMI9lkOATg5cdeXiUKgpmBZ9VbQd1GOCCDn8tSek1svKbCoR98Tlnf9jNpcFAEB0dwkERSdz8OEgGrTuIZLgFauPn5ebMd0b/sDFgGO4ItNmXsUjisx4AHMcnl+NguPR7b1RUO9bLvojHa8tldP2h8sKSORL4PlwAKd+7cuUpHKSmcDDIGIbCC3wL1bYTjdiDwgdwGa7oXG6+pcOhHZ7hJAMkgG6Sz6suoI1GdqWfu9CocsOosqgQaglLvy2gY6EXTwDIoGpDC6L4pYJ0MpwVFX/LHxZLaou0+HKaVOFjS5JwbqJrh2K7K1HMa6E24JiDIZIYDWjDdRmcLgCCXberKR1ksuXXfT209vCrzUiCN3Ab5GfAedVIwSifX19vSVrg200lSZR8OQs5KdgPZCIdA1vLojOJ0A8+9NZ1OkrKp4qlTp8LKyspM7LuRbISDVFo4ZA1M1/S0zGmGPDrZ9FSApGi6OIuygeynlC7bsIFYy8vLq7IcRLx169aoTradBbISznFyx4VznIS4cI6TEBfOcRLiwjlOQlw4x0mIC+ckA+fj6t4RYJ1WyJnehMN1lP5ME3+mSRnTdq1lr8LhbgF/psnwhZv0M03KQJbDJWLTcKK8d+GIP9NkmKR4pkkZzHLTcIPqYIQDZc80sa6S1wErL/+S117qqZyk6sXP1vWcFEf2oS9Bs6SKCYdlPQb6K7pbwLprgUHaNtgn9UwTS8QiOZElp2FaOSjhQOyZJkAHngZ1MvhiFzw3zXCWJFoQLMt6axuA1RfQ/QH5uSmb/B705wZdCTepZ5pY00SIGZt6os6Fa0GTDIfAsoIXoCz2uAMZ1G2EAzL4uVyUIWPjNRUO/egbcdt+Jk2KZ5ow+/FugbJpo2e4lmjhyp5pQhB41lQKwRabMnYpHNZjwIOY5HL8Ond8lwmHetl30RhtmeQzTVhP4YoO/5f1lRO9C1f1mSYaPbWygt8C9W2E47gIfMDxZZ0si43XVDj0ozPcJEjxTBNkLEqE97G2fpSyAyAcsOqqIgORy3pfRsNAL5oGlkHRgBRG900B62Q4LSj6Qgbj57SktmBWiO1DlZHimSYQjKIVTRdRh77Qp1WfE70JVxcGmpxGWXIhEGUbnS0Agly2qSsfZbHG1337M03iIiFj4a7vojaQEW2mIbuBbIRz0pHqmSZlcFo6DftuxIVzxqR8pkkZ0ygbcOGciVJ09LEISBo7iJIzLpzjJMSFc5yEuHCOkxAXznES4sI5TkJcOMdJiAvnOAnpTThcRzmLzzTJBV52de/evRHy5DVPSlc9T4aT19N0eVYbehUOdwukfqZJCnDto3WdZS5QNgpFwSjdkITDNjW5kqUveheOpHqmSQpyF84KYnldZF3hJokLVxEtHCi747stvOoer9ZV9rgLAFf2735wz/hqfH1rDe8U4PrybgTZr0T3odthmXVd0fRugZhMspzvl5aWRq+cdnIdjs1yYGU4tJdtLIEhk2zDayt1Oan7eVMzKOFA0TNN2sJA560ulIcBL2ViGV4ppW7PeimdXodlsk62t/rsgjbC4dpHLYclnJQIIsTGQhvUyT7Rj1wfr3IaCyAVPgM+C8s0nuEq0leG0yKgLCYgwP1tFES+Zz3XkTeSWuMALKNcyxVr3wd1hJNyxNYDKNPCQRJ9J4CUx1rHwoWriBau6jNN2mAFtiyz5JFY61sSxQSK9W+J3BeWTCynUDHhrPWAlseachLKg36wDvqVfWlcuIpQuKbPNGmCJQKym85wMeEsMax1YsJZcoJY+76wglgKYMlVlJGsOvSvM5ykqD+JC1cRCAesukmhAxsHMnBAg7KUCcd6KQxk1bJg/dhTtLCulFZvQ1c03YcDEAnZhkJRMApiCYegj+1vWfJg3aJTBdz+sn24on3HIdKbcH2AYJdHB2NHIIuCn4Kwj1hmgoixcWQd6Fo20EY4QOmIlIt9y/qiLBPLVnoMUDaOzoq6zdDlmznhhjR1mxViws0iLpzTOcgwi4uL4+Wi6easkY1wchqneW3fUnhl7+tmHcG0bejC6SmvBifl8VmtOqCnrn2CqR+neS7bh8xUhnOcvnHhHCchLpzjJMSFc5xkrA//A2O7UWO9JslmAAAAAElFTkSuQmCC"},244:function(t,s,a){t.exports=a.p+"assets/img/refer.0ebcf92f.gif"},348:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"composition-api-初探"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#composition-api-初探"}},[t._v("#")]),t._v(" Composition API 初探")]),t._v(" "),n("h2",{attrs:{id:"好处"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#好处"}},[t._v("#")]),t._v(" 好处")]),t._v(" "),n("p",[t._v("Vue3 的 break changing 就是 composition api, 它打破了以往用 options 构建 Vue 实例的方式. 使用函数来代替. 这次 Vue3 升级的目的是什么呢?官方给出的解释是:")]),t._v(" "),n("h3",{attrs:{id:"_1-代码组合更好"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-代码组合更好"}},[t._v("#")]),t._v(" 1. 代码组合更好")]),t._v(" "),n("p",[t._v("过去使用 options("),n("code",[t._v("data")]),t._v(", "),n("code",[t._v("methods")]),t._v(", "),n("code",[t._v("computed")]),t._v(")来组织代码, 那么关于一个逻辑的代码就要被分散到各个 options 里面. 随着项目变得越来越大,\n整个结构就会变得不可维护, 可读性也很差.")]),t._v(" "),n("h3",{attrs:{id:"_2-便于逻辑分解和复用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-便于逻辑分解和复用"}},[t._v("#")]),t._v(" 2. 便于逻辑分解和复用")]),t._v(" "),n("p",[t._v("Vue 2.x 里的 Mixins 可以为我们提供抽离逻辑并复用的功能. 可是一旦 Mixins 的数量太多, 就会导致一些问题:")]),t._v(" "),n("ol",[n("li",[t._v("命名空间冲突")]),t._v(" "),n("li",[t._v("模板数据来源不清晰")])]),t._v(" "),n("p",[t._v("Vue3 将复用的逻辑以函数的形式组织起来, 在函数体里同样可以使用响应式, 生命周期钩子. 然后用 ES module 来 import 和 export(因此可以 tree shaking). 这样的写法就解决了上面 Mixins 的两个缺点, 也不会带来像高阶组件附带的额外性能开销.")]),t._v(" "),n("h3",{attrs:{id:"_3-全面支持-typescript-增强类型推断"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-全面支持-typescript-增强类型推断"}},[t._v("#")]),t._v(" 3. 全面支持 TypeScript, 增强类型推断")]),t._v(" "),n("p",[t._v("Vue2.x 里面对 TS 的支持是很不友好的. Vue2.x 使用"),n("code",[t._v("this")]),t._v("作为上下文来暴露属性, 而"),n("code",[t._v("this")]),t._v("就是一个黑魔法一样的存在: "),n("code",[t._v("methods")]),t._v("里的"),n("code",[t._v("this")]),t._v("指向的不是\n"),n("code",[t._v("methods")]),t._v("而是 Vue 实例, "),n("code",[t._v("data")]),t._v("里的数据不是用"),n("code",[t._v("vm.data.xxx")]),t._v("来访问而是直接暴露为实例的属性("),n("code",[t._v("vm.xxx")]),t._v(").这些给类型推断会带来极大的麻烦. Vue2.x 的 API 也\n根本不是为了类型推断而设计的. 但是从现在的前端趋势看, 去面向对象化的潮流正在兴起, 函数式编程开始崛起(React Hooks, Vue 3 Composition API). TypeScript 对函数式的支持是天然友好的. 我不知道是谁带动了谁, 但是在 2020 年, TS 和函数式是前端必学的技能.")]),t._v(" "),n("h2",{attrs:{id:"起步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#起步"}},[t._v("#")]),t._v(" 起步")]),t._v(" "),n("h3",{attrs:{id:"代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[t._v("#")]),t._v(" 代码")]),t._v(" "),n("div",{staticClass:"language-vue line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vue"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hello"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("My Event"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Capacity: {{ capacity }}"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@click")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("increaseCapacity()"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Increase Capacity"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@click")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("increment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      Count is {{ state.count }}, double is: {{ state.double }}\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" ref "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@vue/composition-api"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//tree shaking")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// run after beforeCreated and before created")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// refer to reactive reference, return a reactive object")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      double"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// can't be primitive type")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"state"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("increaseCapacity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("increment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" increment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" increaseCapacity "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// return objects & methods that template needs to access")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br")])]),n("h3",{attrs:{id:"引入-composition-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#引入-composition-api"}},[t._v("#")]),t._v(" 引入 composition api")]),t._v(" "),n("p",[n("code",[t._v('import {ref, reactive, computed} from "@vue/composition-api"')])]),t._v(" "),n("p",[t._v("为了使用 tree shaking, 这里使用 import 方式引入")]),t._v(" "),n("h3",{attrs:{id:"setup"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[t._v("#")]),t._v(" "),n("code",[t._v("setup()")])]),t._v(" "),n("p",[n("code",[t._v("setup")]),t._v("函数是 Vue3 新增的 hook, 它在"),n("code",[t._v("beforeCreated")]),t._v("之后又在"),n("code",[t._v("created")]),t._v("之前的阶段执行.")]),t._v(" "),n("h3",{attrs:{id:"ref"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ref"}},[t._v("#")]),t._v(" "),n("code",[t._v("ref()")])]),t._v(" "),n("p",[t._v("调用"),n("code",[t._v("ref()")]),t._v("后, 传入的参数会被修改为一个 reactive object,并且添加"),n("code",[t._v("getter")]),t._v(","),n("code",[t._v("setter")]),t._v(", 使其在改变时会被监听到变动进而更新视图. 参数也被放入到 reactive object 的"),n("code",[t._v("value")]),t._v("属性里. 我们在控制台可以看到"),n("code",[t._v("capacity")]),t._v("是什么:\n"),n("img",{attrs:{src:a(243),alt:"ref"}})]),t._v(" "),n("h3",{attrs:{id:"reactive-computed"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#reactive-computed"}},[t._v("#")]),t._v(" "),n("code",[t._v("reactive()&computed()")])]),t._v(" "),n("p",[n("code",[t._v("reactive")]),t._v("接受一个对象, 返回一个 reactive object. 它在内部可以使用"),n("code",[t._v("computed(fn)")]),t._v(", 但是内部不能使用值类型. "),n("code",[t._v("computed")]),t._v("内部伪代码如下:")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("getter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br")])]),n("p",[t._v("如果是值类型, 那么"),n("code",[t._v("computed")]),t._v("赋值的对象就会重新使用一个内存空间存放"),n("code",[t._v("computed")]),t._v("的返回值. 因此, 对赋值对象的修改不会被依赖追踪发现. 而对象是引用类型, 对它的修改也会导致引用它的对象也发生变化.\n"),n("img",{attrs:{src:a(244),alt:"ref"}})]),t._v(" "),n("p",[t._v("实际上, "),n("code",[t._v("ref()")]),t._v("是"),n("code",[t._v("reactive()")]),t._v("的 fallback, 由于值类型不能在"),n("code",[t._v("reactive()")]),t._v("里使用, 所以 Vue 提供了"),n("code",[t._v("ref()")]),t._v("给我们处理值类型的数据")]),t._v(" "),n("h3",{attrs:{id:"return"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#return"}},[t._v("#")]),t._v(" "),n("code",[t._v("return")])]),t._v(" "),n("p",[t._v("最后我们要将模板里需要的对象和方法返回, 使模板能够访问到.")]),t._v(" "),n("h3",{attrs:{id:"生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生命周期"}},[t._v("#")]),t._v(" 生命周期")]),t._v(" "),n("p",[t._v("Vue3 里的生命周期钩子只能在"),n("code",[t._v("setup()")]),t._v("里使用, 使用方式是接受一个回调:")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("onMounted"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue"')]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("onMounted")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'component is mounted'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);